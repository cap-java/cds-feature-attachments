/**************************************************************************
 * (C) 2019-2024 SAP SE or an SAP affiliate company. All rights reserved. *
 **************************************************************************/
package com.sap.cds.feature.attachments.service.malware;

import com.sap.cds.reflect.CdsEntity;
import com.sap.cds.services.ServiceException;

/**
 * The {@link AttachmentMalwareScanner} is the connection to the malware scan service. It reads the attachment entity,
 * scans the content using the malware scan service and updates the attachment entity with the scan result.
 */
public interface AttachmentMalwareScanner {

	/**
	 * Scans the given attachment for malware and updates the scan result in the attachment entity
	 *
	 * @param attachmentEntity The entity containing the attachment to scan
	 * @param contentId        The content id of the attachment entity
	 * @throws ServiceException Exception to be thrown in case of errors during scanning the content
	 */
	void scanAttachment(CdsEntity attachmentEntity, String contentId);

}
